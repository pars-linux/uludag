Index: pisi/archive.py
===================================================================
--- pisi/archive.py	(revision 21417)
+++ pisi/archive.py	(working copy)
@@ -20,6 +20,8 @@
 import zipfile
 import gzip
 import struct
+import sys
+import distutils.version
 
 import gettext
 __trans = gettext.translation('pisi', fallback=True)
@@ -187,7 +189,7 @@
     def close(self):
         self.tar.close()
 
-        if self.tar.mode == 'wb' and self.type == 'tarlzma':
+        if 'w' in str(self.tar.mode) and self.type == 'tarlzma':
             batch = None
             if ctx.config.values.build.compressionlevel:
                 batch = "lzma -%s -z %s" % (ctx.config.values.build.compressionlevel, self.file_path)
@@ -201,6 +203,16 @@
 
 class MyZipFile(zipfile.ZipFile):
     def decompressToFile(self, name, outname):
+        version = sys.version.split()[0]
+        if distutils.version.StrictVersion(version) < distutils.version.StrictVersion("2.6.0"):
+            self.decompressToFileOld(name, outname)
+        else:
+            self.decompressToFileNew(name, outname)
+
+    def decompressToFileNew(self, name, outname):
+        self.extract(name, os.path.dirname(outname))
+
+    def decompressToFileOld(self, name, outname):
         import zlib
         import binascii
 
