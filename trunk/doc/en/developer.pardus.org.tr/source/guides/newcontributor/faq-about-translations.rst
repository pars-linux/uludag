.. _translations_faq:

======================
FAQ About Translations
======================

1. Internationalization (i18n)
------------------------------

Internationalization is the process of designing a software application so that
it can be adapted to various languages and regions without engineering changes.
This is actually what we are doing when we write the software components like
Managers, YALI, Kaptan, sysinfo, etc, so this isn't a process that you're
directly involved.

In terms of programming, all the strings in an application presented to the
user are wrapped with a function call like i18n(), ki18n(), etc. That's all.
Say that you're printing a welcome message on the screen in Python:

  ``print "Hello"``

This isn't at all translatable to any language as it doesn't support i18n. But
if I import the relevant module and wrap that string by the relevant function
like:

  ``print i18n("Hello")``

the text will be replaced by the meaning of "Hello" in the corresponding
language when a user runs the application.

When the whole software is internationalized, a translation catalogue (a file
with an extension .pot) is generated by browsing all the source code files of
that software.  The catalogue is actually a plain text file which keeps the
strings to be translated and their corresponding translations in a 2-line
format:

::

  # Some comments about where this string is actually
  # coming from in terms of source code file and line number
  msgid "string to be translated 1"
  msgstr ""

and it goes like this.


2. Localization (l10n)
----------------------

Localization is the process of adapting internationalized software for a
specific region or language by adding locale-specific components and
translating text.

Localization is actually what you are doing: Translating the English strings in
the translation catalogue to another language.


3. Workflow between i18n and l10n
---------------------------------

- The developer writes its software with i18n support,

- Once he/she thinks that it's ready for localization, he/she generates a
  translation catalogue from it, basically a .pot file and makes it publicly
  available to you (through SVN in our case),

- The translator takes that .pot file and creates a copy of it which he/she
  calls LANGUAGE.po, e.g.  If I'm translating the software to Turkish, I
  take that .pot file and create a copy of it called tr.po.

- I use vi, nano, mcedit, lokalize, kbabel, or another application to edit
  that tr.po file for translating the strings in it,

- Once I think that it's enough for that day, I commit it back to where it
  belongs in the SVN tree.

 Some more practical rules and advises are below:

- You never touch/modify the .pot file once you copy it as your LANGUAGE.po
  file,

- If there's already a LANGUAGE.po file then it means that somebody has
  already started working on it OR the developer of the software had created
  empty LANGUAGE.po files for your convenience. All you have to do is to
  edit it to fix broken or missing translations and commit it back!


4. What happens when I translate and commit the LANGUAGE.po file to SVN?
------------------------------------------------------------------------

The developers creates a tarball/archive of their project source codes
including the po/ directory which contains all of the translation work done by
you. Once the application becomes a pisi package and you install/upgrade it on
your system, the new translations will immediately be available to you.

If you think that you translated all the strings correctly and committed the
LANGUAGE.po file to SVN, you may sit back and enjoy seeing your translation
work on your screen as you use the related software.

5. Oh, I thought I already completed the translation of Kaptan but there are still English messages in it!
-----------------------------------------------------------------------------------------------------------

Okay, there could be more than one possible cause for this problem. Let's
learn about them:

- You really completed the LANGUAGE.po file and committed it but the
  maintainer of the project wasn't concerned at all to create a new tarball
  and push that as a pisi update to the repository. So your works aren't
  reflected at all to the package. Just send an e-mail to the
  pardus-translators list as early as possible OR fire a bug report in
  bugzilla to poke us,

- You really completed the LANGUAGE.po file and committed it but to the
  wrong directory under SVN. We'll talk about different directory
  hierarchies in SVN a little bit later so keep reading,

- You really think you're completed the LANGUAGE.po file but actually there
  are translations which are marked as fuzzy.  When a translation is marked
  as fuzzy, the English string is displayed instead of the fuzzy
  translation. You have to correct that translation and remove the fuzzy
  mark in the .po file. Let's see an example:

  ::

    #, fuzzy
    msgid "Network settings"
    msgstr "A not-really correct phrase about the original string"

  As you can see, that translation is marked as fuzzy and you'll just see
  "Network settings" instead of the not-really correct fuzzy translation. If
  you're using a graphical tool, re-translating it correctly should be
  sufficient to mark it as non-fuzzy. If you're using a text editor, just
  remove that ", fuzzy" from the line above, that's all,

- You really completed the LANGUAGE.po file but the developer has just added
  a new string and you didn't notice it at all.  In that case your
  LANGUAGE.po file will miss the translation for that new string which will
  cause it to be displayed in English. Just open the LANGUAGE.po file,
  translate the newly added strings and commit it.


6. At the bottom of my LANGUAGE.po file there a lot of translations all starting with #. What am I supposed to do with them?

Nothing! Those are old translations that you've made a while ago but which are
not currently used by the application because the developer decided to not make
them appear on the screen.

When the developer updates the POT and PO files (Don't panic we'll talk about
that too), the removed strings and their translations will be moved to the
bottom of the PO files and be commented out with # characters so that they are
not used at all.


7. I sometimes see that the POT file and all the PO files are modified, what does it mean?

When a developer adds/removes/modifies some strings in its project source
codes, he runs an automated script which reflects that change to the POT and
PO files:

- If there is/are new string(s), you just have to translate it/them in
  LANGUAGE.po and commit your changes back,

- If there is/are removed string(s), its/theirs translation(s) for it/them in
  the PO file is/are moved to the bottom of the file and each commented out
  with an # character. You don't have to do anything in this case,

- If there is/are modified string(s), its/theirs translation becomes fuzzy.
  When you open the LANGUAGE.po file with your favourite localization tool or a
  text editor, you'll see that the relevant translations is/are marked as fuzzy
  (has a # ,fuzzy line above it).  You now have to fix its/their translation(s)
  to unmark it/them as fuzzy.

  Note that you'll see the original English strings instead of fuzzy marked
  translations when you run an application.

9. I'm really confused about the branch/ and trunk/ hierarchy in Pardus SVN
   repository. What are they used for? Where should I commit my translation
   updates?

You're basically working in uludag repository (http://svn.pardus.org.tr/uludag)
which contains the source codes for Pardus technologies.

An SVN project repository is generally divided into three folders:
  - trunk/
  - branches/
  - tags/

"trunk" is the directory under which the main project development occurs,
"branches" is the directory in which you create various named branches of the
main development line, "tags" is a directory of branches that are created, and
perhaps destroyed but never changed.

Now let's forget about tags directory and focus over the other ones.

In trunk, there are several directories for several projects like Kaptan, YALI,
comar, pisi, kde, etc. This where the main development takes place.  For
example, when I found a bug in Kaptan, trunk/kde/kaptan is generally the first
place where I commit my fix.

If I plan to do radical changes to Kaptan e.g. to add different features to it
that will be used in Pardus 2011 but which will not appear in Pardus 2009, I
create a branch in branches/kde/kaptan called for example 2011 and I continue
the development in trunk/kde/kaptan and branches/kde/kaptan/2011 separately.

So, If I add a new string to the 2011 branch of Kaptan and update the POT/PO
files, you have to update the relevant PO files in branches/kde/kaptan/2011/po
directory.

Currently we have two main branches for every project: 2009 and Corporate2.
Both are active and maintained so you should generally be updating both
branches for every project if you see a translation update in uludag-commits.

If there are no modifications to the strings in a specific branch of Kaptan,
and you continue to improve the current translations in trunk/kde/kaptan, this
is the developer's responsibility to take what you changed in trunk/kde/kaptan
and apply them over the relevant branches of Kaptan.


10. It is quite possible to see untranslated strings in KDE applications.
    Since KDE isn't maintained in uludag/ repository, where should I update the translations?

Nice question! This is one of the mysteries for translators. From time to time,
we add new features to the KDE applications that needs for example a button in
the user interface of that application.

The PO files for KDE applications are either coming from the package itself or
from kde-l10n-LANGUAGE packages in the repository.

For example, we recently added a new item in the right-click menu of KMix (The
speaker icon in your system tray) which opens pavucontrol for advanced sound
settings. The feature was added to KMix shipped within the kdemultimedia
package. As kdemultimedia is a base KDE package, all of its PO files comes from
kde-l10n-LANGUAGE packages.

This is the patch applied to kdemultimedia package which adds that item to
KMix:
http://svn.pardus.org.tr/pardus/2009/devel/desktop/kde/base/kdemultimedia/files/kmix-add-pavucontrol-shortcut.patch

::

    Index: kdemultimedia-4.3.3/kmix/kmixdockwidget.cpp
    ===================================================================
    --- kdemultimedia-4.3.3.orig/kmix/kmixdockwidget.cpp
    +++ kdemultimedia-4.3.3/kmix/kmixdockwidget.cpp
    @@ -33,6 +33,8 @@
     #include <kwindowsystem.h>
     #include <kactioncollection.h>
     #include <ktoggleaction.h>
    +#include <kprocess.h>
    +#include <kmessagebox.h>
     #include <qapplication.h>
     #include <qcursor.h>
     #include <QDesktopWidget>
    @@ -98,6 +100,13 @@ void KMixDockWidget::createActions()
         if ( a ) menu->addAction( a );
     }
     
    +  // Add pavucontrol shortcut to the context menu
    +  QAction *paction = actionCollection()->addAction( "run_pavucontrol" );
    +  paction->setText( i18n ("Advanced Sound Control") );                     <-- A new string wrapped by i18n() -->
    +  connect(paction, SIGNAL(triggered(bool) ), SLOT (runPavucontrol() ));
    +  QAction *a1 = actionCollection()->action ("run_pavucontrol" );
    +  if ( a1 ) menu->addAction( a1 );
    +
       // Put "Select Master Channel" dialog in context menu
       if ( m_mixer != 0 ) {
       QAction *action = actionCollection()->addAction( "select_master" );
    @@ -158,6 +167,17 @@ void KMixDockWidget::selectMaster()
         // !! The dialog is modal. Does it delete itself?
     }
     
    +void KMixDockWidget::runPavucontrol()
    +{
    +    KProcess *pulse_proc = new KProcess();
    +    pulse_proc->setProgram("/usr/bin/pavucontrol");
    +
    +    if ( pulse_proc->startDetached() == 0 ) {
    +        // Error
    +        KMessageBox::error(0, i18n("Failed launching pavucontrol, make sure the pavucontrol package is correctly installed."),
    +                              i18n("Error launching pavucontrol"));        <-- Two new strings wrapped by i18n() -->
    +    }
    +}

So when I add this feature to KMix, I also patch the kde-l10n-tr package to
add the translations for those 3 new strings. Let's see this patch:
http://svn.pardus.org.tr/pardus/2009/devel/desktop/kde/l10n/kde-l10n-tr/files/kmix-add-pavucontrol-i18n.patch

::

   Index: kde-l10n-tr-4.3.3/messages/kdemultimedia/kmix.po
   ===================================================================
   --- kde-l10n-tr-4.3.3.orig/messages/kdemultimedia/kmix.po
   +++ kde-l10n-tr-4.3.3/messages/kdemultimedia/kmix.po
   @@ -712,5 +712,14 @@ msgstr "Aygıt Ayarları"
    msgid "Mixer"
    msgstr "Karıştırıcı"

   +msgid "Advanced Sound Control"
   +msgstr "Gelişmiş Ses Denetimi"
   +
   +msgid "Failed launching pavucontrol, make sure the pavucontrol package is correctly installed."
   +msgstr "pavucontrol başlatılamadı, pavucontrol paketinin yüklü olduğundan emin olun."
   +
   +msgid "Error launching pavucontrol"
   +msgstr "pavucontrol başlatılamadı"
   +
    #~ msgid "Current Mixer"
    #~ msgstr "Geçerli Karıştırıcı"

The patch is pretty trivial!

The main problem is that if you don't dig into the paketler-commits list, you
won't notice that right-click menu action addition to KMix until you saw it on
your desktop. We're planning an automated notification system for this kind of
modifications that'll send an e-mail to pardus-translators which will tell
which package you have to patch and what are the added/modified strings in it.

As you don't have access to pardus/ repositories for now, you can't directly
patch packages but if you attach your translation patches in a bug report that
you'll open, we'll apply them as soon as possible to pardus/ repository.

How do i test my translation?
-----------------------------

First of all, if you edited the relevant po file with a text editor, you should
test it with "msgfmt" command. Ex.:

  ``msgfmt -c --statistics <insert_your_language>.po``

The above command first checks whether if there are fatal errors or warnings
with "-c" parameter, then shows the statics of your translation file with
"--statistics" parameter, obviously.

The result should be similar to this:

::

  msgfmt -c --statistics tr.po
  395 translated messages, 1 untranslated message.

If your translation contains missing or extra characters (e.g. extra \n,
missing % character, wrong order of %1 and %2), you will get an error like
this:

::

  msgfmt -c --statistics tr.po
  tr.po:28: `msgid' and `msgstr' entries do not both end with '\n'
  msgfmt: found 1 fatal error
  395 translated messages, 1 untranslated message.

The above output tries to tell us that we have an extra "\n" character on line
28. We should fix it and then repeat the routine again.

If you are satisfied with the result, compile your po file with the command:

  ``msgfmt -o <application>.mo language.po``

This command compiles your po file into a binary format, <application>.mo.
Most of the translation files (compiled ones, mo that is) usually stays in
/usr/share/locale/<language>/LC_MESSAGES directory. KDE has its prefix so KDE
related programs have their translation files in
/usr/kde/4/share/locale/<language>/LC_MESSAGES. If you want to test your
translation effort, copy your mo file to relevant directory. Here's a routine i
use for translating kaptan:

  1) pwd
     /home/igungor/bluebox/uludag/trunk/kde/kaptan/po

  2) vim tr.po (type type type, delete, type, delete. save and exit.)
     (You can use your favourite text editor of course.)

  3) msgfmt -c --statistics tr.po
     154 translated messages, 6 untranslated messages.
     (OK, no warning or fatal error. lets compile it)

  4) msgfmt -o kaptan.mo tr.po
     (we have kaptan.mo in our current working directory after this command if
     you get no output from this command.)

  5) sudo mv kaptan.mo /usr/kde/4/share/locale/tr/LC_MESSAGES/kaptan.mo

  6) LC_ALL=tr_TR kaptan
     (If you are using and English locale and test your application with
     another locale, you can use this command to change your locale for this
     application.)

Voila! We have freshly translated Kaptan now. It is time to commit our changes.

**Last Modified Date:** |today|

:Author: Halil İbrahim Güngör
